# The real gaming experience when booting your System!

This is a guide on how to have two grub menus with different themes at the same time.
I made this so I can use my minegrub-theme that looks like the Minecraft main menu to enter my _second_ minegrub-theme that looks like the minecraft world selection menu _just like in the real game_
Yea, its possible, and its fun

# Installation
- Install your two themes
- In this case:
    ```
    git clone https://github.com/Lxtharia/minegrub-world-sel-theme.git && cd minegrub-world-sel-theme
    sudo cp -ruv minegrub-world-selection /boot/grub/themes/
    cd ..
    # And the other one
    git clone https://github.com/Lxtharia/minegrub-theme.git && cd minegrub-theme
    sudo cp -ruv minegrub/boot/grub/themes/
    ```
- Set your world-selection theme in `/etc/default/grub` and other trivial stuff, you got this
    ```
    GRUB_TIMEOUT_STYLE=menu
    ...
    GRUB_THEME=/boot/grub/themes/minegrub-world-selection/theme.txt
    ...
    GRUB_GFXMODE=...
    ```
    
- copy the files, generate the .cfg and set the env variable
    ```
    sudo cp ./mainmenu.cfg /boot/grub/
    sudo cp ./05_twomenus /etc/grub.d/
    chmod +x /etc/grub.d/05_twomenus

    sudo grub-mkconfig -o /boot/grub/grub.cfg
    sudo grub-editenv - set config_file=mainmenu.cfg
    ```

# Explanation
When grub starts, it by default reads the file `grub.cfg` usally located in `/boot/grub/grub.cfg` to set all the options (like timeout, default boot option, theme) and add all the boot options.
This file is usually generated by `grub-mkconfig` which uses variables set in `/etc/default/grub` and scripts in `/etc/grub.d/*` to create the full config file.

**NOW:** what do we want? (the results to be)
We want to be greeted with the minecraft looking main menu with options like "Singleplayer" "Multiplayer" "Minecraft Realms" (but with cool different nerd terms, see below) and if we select Singleplayer we want to see the world selection menu with all the boot options. If we press escape we return to the main menu.
**NOW:** what do we want? (in funcional terms)
We want that grub reads a .cfg file that sets the theme to the main menu theme and that includes boot options like "Singlebooter" "Onlinebooter" or "UEFI Realms" (so cool). 
And if we select "Singlebooter" we want to load "the real config file" that sets the world-selection theme and that includes all of your personal boot options.

- We need to put some code in grub.cfg, we do that with a file in /etc/grub.d/ that gets copied into the grub.cfg
- To automatically load another configfile we can just call `configfile $prefix/mainmenu.cfg` in grub.cfg
- `$prefix` is the absolute path of your /boot/grub path (this includes which drive/partition this directory is on)
- We put this in an if clause that will check if the enviromental variable `config_file=` is set 
- if yes, we load that file (`configfile $prefix/$config_file`)
- the normally generated grub.cfg automatically loads variables from the file /boot/grub/grubenv, so all we have to do is set it there 
- with `grub-editenv - set config_file=mainmenu.cfg`
- now mainmenu.cfg gets loaded.
- the first menu will load grub.cfg again.
- to prevent grub.cfg to load the other config file again, we put that code into another if clause
- when we select an item, grub sets the variable `chosen`, so we can only load the config file if this variable has not been set yet
- and that's it!
So all we need is:
- A manual config file for the main menu
- A few extra lines of code in the grub.cfg file
- the enviromental variable `config_file`

TLDR:
- grub.cfg loads enviromental variables from /boot/grub/grubenv automatically
- we want grub.cfg to load our main theme .cfg automatically (by reading the env variable `config_file`)
- we now have our main menu and if we select "Singlebooter" it loads the grub.cfg again.
- but now the "chosen" variable is set (because we have chosen an option)
- If this variable is set, we prevent the grub.cfg to load mainmenu.cfg and we see our normal boot options
# Notes
- the fun zone
- i write very long READMEs
- if you generate or copy your grub.cfg to /boot/grub/custom.cfg your grub will be stuck in an infinite loop! (Luckily I learned that in a VM)
- This took more energy from me than it should've
- I'm happy how it turned out, can't wait for all the bug reports
